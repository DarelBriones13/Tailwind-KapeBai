nEvent||{MS_MANIPULATION_STATE_ACTIVE:1,MS_MANIPULATION_STATE_CANCELLED:6,MS_MANIPULATION_STATE_COMMITTED:7,MS_MANIPULATION_STATE_DRAGGING:5,MS_MANIPULATION_STATE_INERTIA:2,MS_MANIPULATION_STATE_PRESELECT:3,MS_MANIPULATION_STATE_SELECTING:4,MS_MANIPULATION_STATE_STOPPED:0},et=t.MSPointerEvent||{MSPOINTER_TYPE_TOUCH:"touch",MSPOINTER_TYPE_PEN:"pen",MSPOINTER_TYPE_MOUSE:"mouse"};ht="onfocusin"in t.document.documentElement;c=null;t.addEventListener(ht?"focusout":"blur",function(n){if(n.target===t){var i=c;i&&g(i,"focusout",st({type:"focusout",target:i,relatedTarget:null}));c=null}});t.document.documentElement.addEventListener(ht?"focusin":"focus",function(n){var t=c;c=n.target;t&&g(t,"focusout",st({type:"focusout",target:t,relatedTarget:c}));c&&g(c,"focusin",st({type:"focusin",target:c,relatedTarget:t}))},!0);nt=function(n,t){t=t||{};this.__eventObject=n;var i=this;Object.keys(t).forEach(function(n){Object.defineProperty(i,n,{value:t[n]})})};["altKey","AT_TARGET","bubbles","BUBBLING_PHASE","button","buttons","cancelable","cancelBubble","CAPTURING_PHASE","clientX","clientY","ctrlKey","currentTarget","defaultPrevented","detail","eventPhase","fromElement","getModifierState","height","hwTimestamp","initEvent","initMouseEvent","initPointerEvent","initUIEvent","isPrimary","isTrusted","layerX","layerY","metaKey","offsetX","offsetY","pageX","pageY","pointerId","pointerType","pressure","preventDefault","relatedTarget","rotation","screenX","screenY","shiftKey","srcElement","stopImmediatePropagation","stopPropagation","target","tiltX","tiltY","timeStamp","toElement","type","view","which","width","x","y","_normalizedType","_fakedBySemanticZoom"].forEach(function(n){Object.defineProperty(nt.prototype,n,{get:function(){var t=this.__eventObject[n];return typeof t=="function"?t.bind(this.__eventObject):t},configurable:!0})});tt={pointerdown:{touch:"touchstart",mspointer:"MSPointerDown",mouse:"mousedown"},pointerup:{touch:"touchend",mspointer:"MSPointerUp",mouse:"mouseup"},pointermove:{touch:"touchmove",mspointer:"MSPointerMove",mouse:"mousemove"},pointerenter:{touch:"touchenter",mspointer:"MSPointerEnter",mouse:"mouseenter"},pointerover:{touch:null,mspointer:"MSPointerOver",mouse:"mouseover"},pointerout:{touch:"touchleave",mspointer:"MSPointerOut",mouse:"mouseout"},pointercancel:{touch:"touchcancel",mspointer:"MSPointerCancel",mouse:null}};h={focusout:{register:gt,unregister:ot},focusin:{register:gt,unregister:ot}};t.PointerEvent||(a={register:yi,unregister:pi},h.pointerdown=a,h.pointerup=a,h.pointermove=a,h.pointerenter=a,h.pointerover=a,h.pointerout=a,h.pointercancel=a);var wi=i.Class.define(function(n){this._callback=n;this._toDispose=[];this._attributeFilter=[];this._scheduled=!1;this._pendingChanges=[];this._observerCount=0;this._handleCallback=this._handleCallback.bind(this);this._targetElements=[]},{observe:function(n,t){this._targetElements.indexOf(n)===-1&&this._targetElements.push(n);this._observerCount++;t.attributes&&this._addRemovableListener(n,"DOMAttrModified",this._handleCallback);t.attributeFilter&&(this._attributeFilter=t.attributeFilter)},disconnect:function(){this._observerCount=0;this._targetElements=[];this._toDispose.forEach(function(n){n()})},_addRemovableListener:function(n,t,i){n.addEventListener(t,i);this._toDispose.push(function(){n.removeEventListener(t,i)})},_handleCallback:function(n){var t,i;(n.stopPropagation(),t=n.attrName,this._attributeFilter.length&&this._attributeFilter.indexOf(t)===-1)||this._targetElements.indexOf(n.target)!==-1&&(i=t.indexOf("aria")>=0,t==="tabindex"&&(t="tabIndex"),this._pendingChanges.push({type:"attributes",target:n.target,attributeName:t}),this._observerCount!==1||i?this._scheduled===!1&&(this._scheduled=!0,r._setImmediate(this._dispatchEvent.bind(this))):this._dispatchEvent())},_dispatchEvent:function(){try{this._callback(this._pendingChanges)}finally{this._pendingChanges=[];this._scheduled=!1}}},{_isShim:!0}),bi=t.MutationObserver||wi,ct=null,ki=i.Class.define(function(){t.addEventListener("resize",this._handleResize.bind(this))},{subscribe:function(n,t){n.addEventListener(this._resizeEvent,t);rt(n,this._resizeClass)},unsubscribe:function(n,t){ut(n,this._resizeClass);n.removeEventListener(this._resizeEvent,t)},_handleResize:function(){for(var i,r=t.document.querySelectorAll("."+this._resizeClass),u=r.length,n=0;n<u;n++)i=t.document.createEvent("Event"),i.initEvent(this._resizeEvent,!1,!0),r[n].dispatchEvent(i)},_resizeClass:{get:function(){return"win-element-resize"}},_resizeEvent:{get:function(){return"WinJSElementResize"}}}),it=i.Class.define(function(n,t,i){i=i||{};this.registerThruWinJSCustomEvents=!!i.registerThruWinJSCustomEvents;this.objectName=n;this.object=t;this.capture={};this.bubble={}},{addEventListener:function(t,i,r,u){i=i.toLowerCase();var e=this._getHandlers(u),f=e[i];f||(f=this._getListener(i,u),f.refCount=0,e[i]=f,this.registerThruWinJSCustomEvents?n._addEventListener(this.object,i,f,u):this.object.addEventListener(i,f,u));f.refCount++;t.addEventListener(this._getEventName(i,u),r);rt(t,this._getClassName(i,u))},removeEventListener:function(t,i,r,u){i=i.toLowerCase();var e=this._getHandlers(u),f=e[i];f&&(f.refCount--,f.refCount===0&&(this.registerThruWinJSCustomEvents?n._removeEventListener(this.object,i,f,u):this.object.removeEventListener(i,f,u),delete e[i]));ut(t,this._getClassName(i,u));t.removeEventListener(this._getEventName(i,u),r)},_getHandlers:function(n){return n?this.capture:this.bubble},_getClassName:function(n,t){var i=t?"capture":"bubble";return"win-"+this.objectName.toLowerCase()+"-event-"+n+i},_getEventName:function(n,t){var i=t?"capture":"bubble";return"WinJS"+this.objectName+"Event-"+n+i},_getListener:function(n,i){var r=function(r){for(var u,s,o=t.document.querySelectorAll("."+this._getClassName(n,i)),h=o.length,f=!1,e=0;e<h;e++)u=t.document.createEvent("Event"),u.initEvent(this._getEventName(n,i),!1,!0),u.detail={originalEvent:r},s=o[e].dispatchEvent(u),f=f||!s;return f};return r.bind(this)}}),lt=!1,at=!1,ni=!1;var gi=t.navigator.msManipulationViewsEnabled||t.navigator.userAgent.indexOf("MSAppHost")>=0,nr=!!(t.MSPointerEvent||t.TouchEvent),tr=0;pt=".win-selectionborder, .win-selectionbackground, .win-selectioncheckmark, .win-selectioncheckmarkbackground";k="_msDataKey";i.Namespace._moduleDefine(n,"WinJS.Utilities",{_dataKey:k,_supportsSnapPoints:{get:function(){return gi}},_supportsTouchDetection:{get:function(){return nr}},_uniqueID:ri,_ensureId:ir,_clamp:ft,_getCursorPos:rr,_getElementsByClasses:ur,_createGestureRecognizer:function